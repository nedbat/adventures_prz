<!DOCTYPE html> <!-- vim: set foldmethod=marker foldlevel=0 cc=60 :-->
<!--
Values to change when making a new prez:

    shorturl -> bit.ly short url, or remove those lines.

Process this file with cog:

    $ pip install -r requirements.txt
    $ python -m cogapp -r adventures.html

-->
<html>
<!-- *** Head stuff {{{ -->
<!--[[[cog
import cog
from cogutil import *
]]]-->
<!--[[[end]]]-->
<head>
<title>Adventures</title>
<meta charset="utf-8" />

    <!-- *** Includes {{{ -->
    <!-- Slippy core file and dependencies -->
    <script type="text/javascript" src="slippy/jquery.min.js"></script>
    <script type="text/javascript" src="slippy/jquery.history.js"></script>
    <script type="text/javascript" src="slippy/slippy.js"></script>
    <script type="text/javascript" src="typogr.min.js"></script>

    <!-- Slippy structural styles -->
    <link type="text/css" rel="stylesheet" href="slippy/slippy.css"/>
    <!-- Slippy theme -->
    <link type="text/css" rel="stylesheet" href="slippy/slippy-pure.css"/>
    <!-- Our styles -->
    <link type="text/css" rel="stylesheet" href="slides.css"/>

    <!-- Highlight, for syntax coloring. -->
    <script type="text/javascript" src="highlight/highlight.pack.js"></script>
    <link rel="stylesheet" href="highlight/vs.css">

    <script type="text/javascript" src="lineselect.js"></script>

    <!-- http://html.adobe.com/edge/webfonts/ -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800' rel='stylesheet' type='text/css'>
    <!-- }}} -->

    <script type="text/javascript" src="slides.js"></script>
    <!-- }}} -->

    <!-- *** Custom style for this deck {{{ -->
    <style type="text/css">
    .slide pre {
        line-height: 1.25;
    }
    </style>
    <!-- }}} -->

</head>
<!-- }}} -->
<body class="slides">

<div class="slide title" data-layout="clean">
    <h1>Advent-ures</h1>
    <h2>
        Ned Batchelder<br/>
        <a class="implicit" href="http://twitter.com/nedbat">@nedbat</a>
        <br/>
        <a class="implicit" href="https://twitter.com/nedbat" target="_blank"><img class='icon' src='twitter.png' /></a>
        <a class="implicit" href="https://github.com/nedbat" target="_blank"><img class='icon' src='github.png' /></a>
        <a class="implicit" href="https://instagram.com/nedbat" target="_blank"><img class='icon' src='instagram.png' /></a>
        <br/><br/>
        <a class="implicit" href="http://bit.ly/shorturl"><span class="punct">http://</span>bit.ly<span class="punct">/</span>shorturl</a>
    </h2>
</div>

<div class="text"><!-- {{{ -->

<p>Blah blah blah.</p>

</div><!-- }}} -->


<div class="slide">
    <h1>Advent of Code</h1>
    <ul>
    <li class="incremental">http://adventofcode.com</li>
    </ul>
</div>

<div class="slide">
    <h1>12/14/2016</h1>
    <ul>
    <li class="incremental">"Santa's one-time cryptography pad"</li>
    <li class="incremental">Given a seed</li>
    <li class="incremental">Find numbers where:
        <ul>
        <li class="incremental">md5(seed + num) has a <b>3x</b> char</li>
        <li class="incremental">one of the next 1000 numbers has that char <b>5x</b></li>
        </ul>
    </ul>
</div>


<div class="slide fadeout">
    <h1>For example</h1>
    <pre class="clear python">
    <span>seed = 'foo'</span>
    <span class="incremental">md5('foo1') &rarr; a1b2c3d4</span>
    <span class="incremental">md5('foo2') &rarr; 9a8b7c6d</span>
    <span class="incremental">md5('foo3') &rarr; ff0ee1dd</span>
    <span class="incremental">md5('foo4') &rarr; a1<u><b>bbb</b></u>3d4     # Triple b!</span>
    <span class="incremental">                           md5('foo5') &rarr; 987abc65</span>
    <span class="incremental">                           md5('foo6') &rarr; a32cac67</span>
    <span class="incremental">                           md5('foo7') &rarr; 4e60f111</span>
    <span class="incremental">                           ...</span>
    <span class="incremental">                           md5('foo241') &rarr; 3a<u><b>bbbbb</b></u>0</span>
    <span class="incremental">                           4 is a key!</span>
    </pre>
</div>

<div class="slide fadein fadeout">
    <h1>Keep looking</h1>
    <pre class="clear python">
    <span>seed = 'foo'</span>
    <span class="xncremental">md5('foo1') &rarr; a1b2c3d4</span>
    <span class="xncremental">md5('foo2') &rarr; 9a8b7c6d</span>
    <span class="xncremental">md5('foo3') &rarr; ff0ee1dd</span>
    <span class="xncremental">md5('foo4') &rarr; a1bbb3d4</span>
    <span class="incremental">md5('foo5') &rarr; 987abc65</span>
    <span class="incremental">md5('foo6') &rarr; a32cac67</span>
    <span class="incremental">md5('foo7') &rarr; 4e60f<u>111</u>     # Triple 1!</span>
    <span class="incremental">                           md5('foo8') &rarr; c1bd8e78</span>
    <span class="incremental">                           ...</span>
    <span class="incremental">                           md5('foo1007') &rarr; f5e02b34</span>
    <span class="incremental">                           7 is not a key....</span>
    </pre>
</div>

<div class="slide fadein">
    <h1>Keep looking</h1>
    <pre class="clear python">
    <span>seed = 'foo'</span>
    <span class="xncremental">md5('foo1') &rarr; a1b2c3d4</span>
    <span class="xncremental">md5('foo2') &rarr; 9a8b7c6d</span>
    <span class="xncremental">md5('foo3') &rarr; ff0ee1dd</span>
    <span class="xncremental">md5('foo4') &rarr; a1bbb3d4</span>
    <span class="xncremental">md5('foo5') &rarr; 987abc65</span>
    <span class="xncremental">md5('foo6') &rarr; a32cac67</span>
    <span class="xncremental">md5('foo7') &rarr; 4e60f111</span>
    <span class="incremental">md5('foo8') &rarr; c1bd8e78</span>
    <span class="incremental">md5('foo9') &rarr; d8a9112f</span>
    <span class="incremental">...</span>
    <span class="incremental">... until we find the 64th key</span>
    </pre>
</div>

<div class="slide">
    <h1>Hashing</h1>
    <!--[[[cog include_file("naive.py", start_from="def salted_hash", end_at="return")   ]]] {{{ -->
    <pre class='python'>
    def salted_hash(salt, i):
        bytes = f"{salt}{i}".encode("ascii")
        return hashlib.md5(bytes).hexdigest()
    </pre>
    <!--[[[end]]] }}} -->
</div>

<div class="slide">
    <h1>Finding triples</h1>
    <!--[[[cog include_file("naive.py", start_from="def triple", end_at="return")   ]]] {{{ -->
    <pre class='python'>
    def triple(s):
        # Return a triple character, or None.
        m = re.search(r"(.)\1\1", s)
        if m:
            return m.group(1)
    </pre>
    <!--[[[end]]] }}} -->
</div>

<div class="slide">
    <h1>Finding keys</h1>
    <!--[[[cog include_file("naive.py", start_from="def is_key", line_count=14)   ]]] {{{ -->
    <pre class='python'>
    def is_key(salt, candidate):
        # Is `candidate` a key?
        h = salted_hash(salt, candidate)
        t = triple(h)
        if t is None:
            return False

        # We have a triple. Look ahead for a quint.
        for check_ahead in range(1, 1001):
            h2 = salted_hash(salt, candidate + check_ahead)
            if t*5 in h2:
                return True

        return False
    </pre>
    <!--[[[end]]] }}} -->
</div>

<div class="slide">
    <h1>The 64th key</h1>
    <!--[[[cog include_file("naive.py", start_from="def nth_key", line_count=10)   ]]] {{{ -->
    <pre class='python'>
    def nth_key(salt, n):
        # Find the `n`th key starting with `salt`.
        candidate = 0
        num_keys = 0
        while True:
            if is_key(salt, candidate):
                num_keys += 1
                if num_keys == n:
                    return candidate
            candidate += 1
    </pre>
    <!--[[[end]]] }}} -->
</div>

<div class="slide">
    <h1>The answer</h1>
    <!--[[[cog include_file("naive.py", start_from="INPUT", line_count=3)   ]]] {{{ -->
    <pre class='python'>
    INPUT = 'zpqevtbw'  # This will be different for you.
    k64 = nth_key(INPUT, 64)
    print(f"Puzzle 1: the 64th key is at index {k64}")
    </pre>
    <!--[[[end]]] }}} -->
    <pre class="plaintext incremental">
    $ python naive.py
    Puzzle 1: the 64th key is at index 16106
    </pre>
</div>


<!--
<div class="slide section" data-layout="clean">
    <h1><label>A section</label> Section The First</h1>
</div>
-->

<div class="slide title" data-layout="clean">
    <h1 style="padding-top: 0em">Questions?</h1>
    <h2 style="margin-top: 5em">
        <a class="implicit" href="http://twitter.com/nedbat">@nedbat</a>
        <br/>
        <a class="implicit" href="https://twitter.com/nedbat" target="_blank"><img class='icon' src='twitter.png' /></a>
        <a class="implicit" href="https://github.com/nedbat" target="_blank"><img class='icon' src='github.png' /></a>
        <a class="implicit" href="https://instagram.com/nedbat" target="_blank"><img class='icon' src='instagram.png' /></a>
    </h2>
    <h2><a class="implicit" href="http://bit.ly/shorturl"><span class="punct">http://</span>bit.ly<span class="punct">/</span>shorturl</a></h2>
</div>


<!-- ** Layouts {{{ -->
<div class="layout" data-name="default">
    <content></content>
    <div class="footer">
        <span class="left"><a class="implicit" href="http://bit.ly/shorturl">bit.ly<span class='punct'>/</span>shorturl</a></span>
        <span class="right"><a class="implicit" href="http://twitter.com/nedbat"><span class='punct'>@</span>nedbat</a></span>
        <hr class="defloat" />
    </div>
</div>

<div class="layout nofooter" data-name="clean">
    <content></content>
</div>
<!-- }}} -->

</body>
</html>
